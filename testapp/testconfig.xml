<debut>

	<source type="mysql">
		<ip>127.0.0.1</ip>
		<port>3306</port>
		<name>TestPFE</name>
		<user>root</user>
		<password>root</password>
	</source>

	<cible type="hbase">
		<ip>127.0.0.1</ip>
		<port>2181</port>
	</cible>

	<StructureCible>
		<name>EMPLOYEES</name>
		<cols CF="FAMILY_EMPLOYEE;ADDRESS_EMPLOYEE" />
	</StructureCible>

	<VariablesGlobales>
		<vg name="tauxr" value="#getcurrency('http://demo1525832.mockable.io/currency')" />
	</VariablesGlobales>

<transformation id="0" tablesource="user">
	<RichKeyMapping  targettable="EMPLOYEES" columnqualifier="FAMILY_EMPLOYEE:name"      idrow="#userId"  ignore="true"  condition="1 eq 1 ? true : false"    mappingformula="#firstName+' '+#lastName"/>
	<RichKeyMapping  targettable="EMPLOYEES" columnqualifier="FAMILY_EMPLOYEE:age"       idrow="#userId" ignore="true"  condition="1 eq 1 ? true : false"    mappingformula="#getAge(#birthDate)"/>
	<RichKeyMapping  targettable="EMPLOYEES" columnqualifier="FAMILY_EMPLOYEE:salaire"   idrow="#userId" ignore="true" condition="#salaire gt 300 ? true : false" mappingformula="T(java.lang.String).valueOf(#salaire *#tauxr)" />
	<RichKeyMapping  targettable="EMPLOYEES" columnqualifier="FAMILY_EMPLOYEE:taille"    idrow="#userId" ignore="true"  condition="#taille ne null ? true : false"  mappingformula="#formatNumber(#taille)"/>
	<RichKeyMapping  targettable="EMPLOYEES" columnqualifier="FAMILY_EMPLOYEE:birthdate" idrow="#userId" ignore="false"  condition="#birthDate matches '^(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.](19|20)\d\d$'"  mappingformula="#birthDate"/>
</transformation>
<agregations>

	<agregation idrow="#userId" colonnessources="user:userId;address:addressId;address:pays;address:ville;address:rue;address:codePostal"
				targetcolonnes="FAMILY_EMPLOYEE:Iduser" targettable="EMPLOYEES" key="user:userId;address:userByUserId"/>

</agregations>

</debut>
